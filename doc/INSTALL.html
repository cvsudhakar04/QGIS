<p>QGIS Building QGIS from source - step by step</p>
<ol type="1">
<li><a href="#1-introduction">Introduction</a></li>
<li><a href="#2-overview">Overview</a></li>
<li><a href="#3-building-on-gnulinux">Building on GNU/Linux</a></li>
<li><a href="#3-building-on-windows">Building on Windows</a></li>
<li><a href="#4-building-on-macos-x">Building on MacOS X</a></li>
<li><a href="#6-setting-up-the-wcs-test-server-on-gnulinux">Setting up the WCS test server on GNU/Linux</a></li>
<li><a href="#7-setting-up-a-jenkins-build-server">Setting up a Jenkins Build Server</a></li>
<li><a href="#8-debug-output-and-running-tests">Debug output and running tests</a></li>
<li><a href="#9-authors-and-acknowledgments">Authors and Acknowledgments</a></li>
</ol>
<h1 id="introduction">1. Introduction</h1>
<p>This document is the original installation guide of the described software QGIS. The software and hardware descriptions named in this document are in most cases registered trademarks and are therefore subject to the legal requirements. QGIS is subject to the GNU General Public License. Find more information on the QGIS Homepage: http://qgis.org</p>
<p>The details, that are given in this document have been written and verified to the best of knowledge and responsibility of the editors. Nevertheless, mistakes concerning the content are possible. Therefore, all data are not liable to any duties or guarantees. The editors and publishers do not take any responsibility or liability for failures and their consequences. You are always welcome for indicating possible mistakes.</p>
<p>Because the code of QGIS evolves from release to release, These instructions are regularly updated to match the corresponding release. Instructions for the current master branch are available at https://raw.github.com/qgis/QGIS/master/doc/INSTALL.md. If you wish to build another version of QGIS, ensure to checkout the appropriate release branch. The QGIS source code can be found <a href="https://github.com/qgis/QGIS">in the repository</a>.</p>
<p>Please visit http://qgis.org for information on joining our mailing lists and getting involved in the project further.</p>
<p><strong>Note to document writers:</strong> Please use this document as the central place for describing build procedures. Please do not remove this notice.</p>
<h1 id="overview">2. Overview</h1>
<p>QGIS, like a number of major projects (e.g., KDE 4.0), uses <a href="http://www.cmake.org">CMake</a> for building from source.</p>
<p>Following a summary of the required dependencies for building:</p>
<p>Required build tools:</p>
<ul>
<li>CMake &gt;= 3.0.0</li>
<li>Flex &gt;= 2.5.6</li>
<li>Bison &gt;= 2.4</li>
<li>Python 3</li>
</ul>
<p>Required build dependencies:</p>
<ul>
<li>Qt &gt;= 5.9.0</li>
<li>Proj &gt;= 4.9.3</li>
<li>GEOS &gt;= 3.4</li>
<li>Sqlite3 &gt;= 3.0.0</li>
<li>SpatiaLite &gt;= 4.2.0</li>
<li>libspatialindex</li>
<li>GDAL/OGR &gt;= 2.1</li>
<li>Qwt &gt;= 5.0 &amp; (&lt; 6.1 with internal QwtPolar)</li>
<li>expat &gt;= 1.95</li>
<li>QScintilla2</li>
<li>QCA</li>
<li>qtkeychain (&gt;= 0.5)</li>
<li>libzip</li>
</ul>
<p>Optional dependencies:</p>
<ul>
<li>for GRASS providers and plugin - GRASS &gt;= 7.0.0.</li>
<li>for georeferencer - GSL &gt;= 1.8</li>
<li>for PostGIS support - PostgreSQL &gt;= 8.0.x</li>
<li>for gps plugin - gpsbabel</li>
<li>for mapserver export and PyQGIS - Python &gt;= 3.3</li>
<li>for python support - SIP &gt;= 4.12, PyQt &gt;= 5.3 must match Qt version, Qscintilla2</li>
<li>for qgis mapserver - FastCGI</li>
<li>for oracle provider - Oracle OCI library</li>
</ul>
<p>Indirect dependencies:</p>
<p>Some proprietary formats (e.g., ECW and MrSid) supported by GDAL require proprietary third party libraries. QGIS doesn’t need any of those itself to build, but will only support those formats if GDAL is built accordingly. Refer to <a href="http://gdal.org/formats_list.html">format list</a> for instructions how to include those formats in GDAL.</p>
<h1 id="building-on-gnulinux">3. Building on GNU/Linux</h1>
<h2 id="building-qgis-with-qt-5.x">3.1. Building QGIS with Qt 5.x</h2>
<p><strong>Requires:</strong> Ubuntu / Debian derived distro</p>
<p><strong>Note:</strong> Refer to the section Building Debian packages for building debian packages. Unless you plan to develop on QGIS, that is probably the easiest option to compile and install QGIS.</p>
<p>These notes are for Ubuntu - other versions and Debian derived distros may require slight variations in package names.</p>
<p>These notes are for if you want to build QGIS from source. One of the major aims here is to show how this can be done using binary packages for<strong><em>all</em></strong> dependencies - building only the core QGIS stuff from source. I prefer this approach because it means we can leave the business of managing system packages to apt and only concern ourselves with coding QGIS!</p>
<p>This document assumes you have made a fresh install and have a ‘clean’ system. These instructions should work fine if this is a system that has already been in use for a while, you may need to just skip those steps which are irrelevant to you.</p>
<h2 id="prepare-apt">3.2. Prepare apt</h2>
<p>The packages QGIS depends on to build are available in the “universe” component of Ubuntu. This is not activated by default, so you need to activate it:</p>
<ol type="1">
<li>Edit your /etc/apt/sources.list file.</li>
<li>Uncomment all the lines starting with “deb”</li>
</ol>
<p>Also you will need a recent enough distribution in order for all dependencies to be met. The supported distributions are listed in the following section.</p>
<p>Now update your local sources database:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a>    <span class="fu">sudo</span> apt-get update</span></code></pre></div>
<h2 id="install-build-dependencies">3.3. Install build dependencies</h2>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution</th>
<th>Install command for packages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>buster</td>
<td><code>apt-get install bison ca-certificates ccache cmake cmake-curses-gui dh-python doxygen expect flex flip gdal-bin git graphviz grass-dev libexiv2-dev libexpat1-dev libfcgi-dev libgdal-dev libgeos-dev libgsl-dev libpq-dev libproj-dev libprotobuf-dev libqca-qt5-2-dev libqca-qt5-2-plugins libqscintilla2-qt5-dev libqt5opengl5-dev libqt5serialport5-dev libqt5sql5-sqlite libqt5svg5-dev libqt5webkit5-dev libqt5xmlpatterns5-dev libqwt-qt5-dev libspatialindex-dev libspatialite-dev libsqlite3-dev libsqlite3-mod-spatialite libyaml-tiny-perl libzip-dev lighttpd locales ninja-build ocl-icd-opencl-dev opencl-headers pkg-config poppler-utils protobuf-compiler pyqt5-dev pyqt5-dev-tools pyqt5.qsci-dev python3-all-dev python3-autopep8 python3-dateutil python3-dev python3-future python3-gdal python3-httplib2 python3-jinja2 python3-lxml python3-markupsafe python3-mock python3-nose2 python3-owslib python3-plotly python3-psycopg2 python3-pygments python3-pyproj python3-pyqt5 python3-pyqt5.qsci python3-pyqt5.qtsql python3-pyqt5.qtsvg python3-pyqt5.qtwebkit python3-requests python3-sip python3-sip-dev python3-six python3-termcolor python3-tz python3-yaml qt3d-assimpsceneimport-plugin qt3d-defaultgeometryloader-plugin qt3d-gltfsceneio-plugin qt3d-scene2d-plugin qt3d5-dev qt5-default qt5keychain-dev qtbase5-dev qtbase5-private-dev qtpositioning5-dev qttools5-dev qttools5-dev-tools saga spawn-fcgi txt2tags xauth xfonts-100dpi xfonts-75dpi xfonts-base xfonts-scalable xvfb</code></td>
</tr>
<tr class="even">
<td>bionic</td>
<td><code>apt-get install bison ca-certificates ccache cmake cmake-curses-gui dh-python doxygen expect flex flip gdal-bin git graphviz grass-dev libexiv2-dev libexpat1-dev libfcgi-dev libgdal-dev libgeos-dev libgsl-dev libpq-dev libproj-dev libprotobuf-dev libqca-qt5-2-dev libqca-qt5-2-plugins libqscintilla2-qt5-dev libqt5opengl5-dev libqt5serialport5-dev libqt5sql5-sqlite libqt5svg5-dev libqt5webkit5-dev libqt5xmlpatterns5-dev libqwt-qt5-dev libspatialindex-dev libspatialite-dev libsqlite3-dev libsqlite3-mod-spatialite libyaml-tiny-perl libzip-dev lighttpd locales ninja-build ocl-icd-opencl-dev opencl-headers pkg-config poppler-utils protobuf-compiler pyqt5-dev pyqt5-dev-tools pyqt5.qsci-dev python3-all-dev python3-autopep8 python3-dateutil python3-dev python3-future python3-gdal python3-httplib2 python3-jinja2 python3-lxml python3-markupsafe python3-mock python3-nose2 python3-owslib python3-plotly python3-psycopg2 python3-pygments python3-pyproj python3-pyqt5 python3-pyqt5.qsci python3-pyqt5.qtsql python3-pyqt5.qtsvg python3-pyqt5.qtwebkit python3-requests python3-sip python3-sip-dev python3-six python3-termcolor python3-tz python3-yaml qt3d-assimpsceneimport-plugin qt3d-defaultgeometryloader-plugin qt3d-gltfsceneio-plugin qt3d-scene2d-plugin qt3d5-dev qt5-default qt5keychain-dev qtbase5-dev qtbase5-private-dev qtpositioning5-dev qttools5-dev qttools5-dev-tools saga spawn-fcgi txt2tags xauth xfonts-100dpi xfonts-75dpi xfonts-base xfonts-scalable xvfb</code></td>
</tr>
<tr class="odd">
<td>eoan</td>
<td><code>apt-get install bison ca-certificates ccache cmake cmake-curses-gui dh-python doxygen expect flex flip gdal-bin git graphviz grass-dev libexiv2-dev libexpat1-dev libfcgi-dev libgdal-dev libgeos-dev libgsl-dev libpq-dev libproj-dev libprotobuf-dev libqca-qt5-2-dev libqca-qt5-2-plugins libqscintilla2-qt5-dev libqt5opengl5-dev libqt5serialport5-dev libqt5sql5-sqlite libqt5svg5-dev libqt5webkit5-dev libqt5xmlpatterns5-dev libqwt-qt5-dev libspatialindex-dev libspatialite-dev libsqlite3-dev libsqlite3-mod-spatialite libyaml-tiny-perl libzip-dev lighttpd locales ninja-build ocl-icd-opencl-dev opencl-headers pkg-config poppler-utils protobuf-compiler pyqt5-dev pyqt5-dev-tools pyqt5.qsci-dev python3-all-dev python3-autopep8 python3-dateutil python3-dev python3-future python3-gdal python3-httplib2 python3-jinja2 python3-lxml python3-markupsafe python3-mock python3-nose2 python3-owslib python3-plotly python3-psycopg2 python3-pygments python3-pyproj python3-pyqt5 python3-pyqt5.qsci python3-pyqt5.qtsql python3-pyqt5.qtsvg python3-pyqt5.qtwebkit python3-requests python3-sip python3-sip-dev python3-six python3-termcolor python3-tz python3-yaml qt3d-assimpsceneimport-plugin qt3d-defaultgeometryloader-plugin qt3d-gltfsceneio-plugin qt3d-scene2d-plugin qt3d5-dev qt5-default qt5keychain-dev qtbase5-dev qtbase5-private-dev qtpositioning5-dev qttools5-dev qttools5-dev-tools saga spawn-fcgi txt2tags xauth xfonts-100dpi xfonts-75dpi xfonts-base xfonts-scalable xvfb</code></td>
</tr>
<tr class="even">
<td>focal</td>
<td><code>apt-get install bison ca-certificates ccache cmake cmake-curses-gui dh-python doxygen expect flex flip gdal-bin git graphviz grass-dev libexiv2-dev libexpat1-dev libfcgi-dev libgdal-dev libgeos-dev libgsl-dev libpq-dev libproj-dev libprotobuf-dev libqca-qt5-2-dev libqca-qt5-2-plugins libqscintilla2-qt5-dev libqt5opengl5-dev libqt5serialport5-dev libqt5sql5-sqlite libqt5svg5-dev libqt5webkit5-dev libqt5xmlpatterns5-dev libqwt-qt5-dev libspatialindex-dev libspatialite-dev libsqlite3-dev libsqlite3-mod-spatialite libyaml-tiny-perl libzip-dev lighttpd locales ninja-build ocl-icd-opencl-dev opencl-headers pkg-config poppler-utils protobuf-compiler pyqt5-dev pyqt5-dev-tools pyqt5.qsci-dev python3-all-dev python3-autopep8 python3-dateutil python3-dev python3-future python3-gdal python3-httplib2 python3-jinja2 python3-lxml python3-markupsafe python3-mock python3-nose2 python3-owslib python3-plotly python3-psycopg2 python3-pygments python3-pyproj python3-pyqt5 python3-pyqt5.qsci python3-pyqt5.qtsql python3-pyqt5.qtsvg python3-pyqt5.qtwebkit python3-requests python3-sip python3-sip-dev python3-six python3-termcolor python3-tz python3-yaml qt3d-assimpsceneimport-plugin qt3d-defaultgeometryloader-plugin qt3d-gltfsceneio-plugin qt3d-scene2d-plugin qt3d5-dev qt5-default qt5keychain-dev qtbase5-dev qtbase5-private-dev qtpositioning5-dev qttools5-dev qttools5-dev-tools saga spawn-fcgi txt2tags xauth xfonts-100dpi xfonts-75dpi xfonts-base xfonts-scalable xvfb</code></td>
</tr>
<tr class="odd">
<td>sid</td>
<td><code>apt-get install bison ca-certificates ccache cmake cmake-curses-gui dh-python doxygen expect flex flip gdal-bin git graphviz grass-dev libexiv2-dev libexpat1-dev libfcgi-dev libgdal-dev libgeos-dev libgsl-dev libpq-dev libproj-dev libprotobuf-dev libqca-qt5-2-dev libqca-qt5-2-plugins libqscintilla2-qt5-dev libqt5opengl5-dev libqt5serialport5-dev libqt5sql5-sqlite libqt5svg5-dev libqt5webkit5-dev libqt5xmlpatterns5-dev libqwt-qt5-dev libspatialindex-dev libspatialite-dev libsqlite3-dev libsqlite3-mod-spatialite libyaml-tiny-perl libzip-dev lighttpd locales ninja-build ocl-icd-opencl-dev opencl-headers pkg-config poppler-utils protobuf-compiler pyqt5-dev pyqt5-dev-tools pyqt5.qsci-dev python3-all-dev python3-autopep8 python3-dateutil python3-dev python3-future python3-gdal python3-httplib2 python3-jinja2 python3-lxml python3-markupsafe python3-mock python3-nose2 python3-owslib python3-plotly python3-psycopg2 python3-pygments python3-pyproj python3-pyqt5 python3-pyqt5.qsci python3-pyqt5.qtsql python3-pyqt5.qtsvg python3-pyqt5.qtwebkit python3-requests python3-sip python3-sip-dev python3-six python3-termcolor python3-tz python3-yaml qt3d-assimpsceneimport-plugin qt3d-defaultgeometryloader-plugin qt3d-gltfsceneio-plugin qt3d-scene2d-plugin qt3d5-dev qt5-default qt5keychain-dev qtbase5-dev qtbase5-private-dev qtpositioning5-dev qttools5-dev qttools5-dev-tools saga spawn-fcgi txt2tags xauth xfonts-100dpi xfonts-75dpi xfonts-base xfonts-scalable xvfb</code></td>
</tr>
</tbody>
</table>
<p>(extracted from the control.in file in <code>debian/</code>)</p>
<p>See <a href="http://qgis.org/en/site/forusers/alldownloads.html#debian-ubuntu">debian-ubuntu</a> for currently supported distributions (plain xenial’s GDAL for instance is to old and we build with GDAL2 from ubuntugis).</p>
<h2 id="setup-ccache-optional-but-recommended">3.4. Setup ccache (Optional, but recommended)</h2>
<p>You should also setup ccache to speed up compile times:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a>    <span class="bu">cd</span> /usr/local/bin</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="fu">sudo</span> ln -s /usr/bin/ccache gcc</span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="fu">sudo</span> ln -s /usr/bin/ccache g++</span></code></pre></div>
<p>or simply add <code>/usr/lib/ccache</code> to your <code>PATH</code>.</p>
<h2 id="prepare-your-development-environment">3.5. Prepare your development environment</h2>
<p>As a convention I do all my development work in $HOME/dev/<language>, so in this case we will create a work environment for C++ development work like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a>    <span class="fu">mkdir</span> -p <span class="va">${HOME}</span>/dev/cpp</span>
<span id="cb3-2"><a href="#cb3-2"></a>    <span class="bu">cd</span> <span class="va">${HOME}</span>/dev/cpp</span></code></pre></div>
<p>This directory path will be assumed for all instructions that follow.</p>
<h2 id="check-out-the-qgis-source-code">3.6. Check out the QGIS Source Code</h2>
<p>There are two ways the source can be checked out. Use the anonymous method if you do not have edit privileges for the QGIS source repository, or use the developer checkout if you have permissions to commit source code changes.</p>
<ol type="1">
<li>Anonymous Checkout</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a>    <span class="bu">cd</span> <span class="va">${HOME}</span>/dev/cpp</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="fu">git</span> clone git://github.com/qgis/QGIS.git</span></code></pre></div>
<ol start="2" type="1">
<li>Developer Checkout</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a>    <span class="bu">cd</span> <span class="va">${HOME}</span>/dev/cpp</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="fu">git</span> clone git@github.com:qgis/QGIS.git</span></code></pre></div>
<h2 id="starting-the-compile">3.7. Starting the compile</h2>
<p>I compile my development version of QGIS into my ~/apps directory to avoid conflicts with Ubuntu packages that may be under /usr. This way for example you can use the binary packages of QGIS on your system along side with your development version. I suggest you do something similar:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a>    <span class="fu">mkdir</span> -p <span class="va">${HOME}</span>/apps</span></code></pre></div>
<p>Now we create a build directory and run ccmake:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a>    <span class="bu">cd</span> QGIS</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="fu">mkdir</span> build-master</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="bu">cd</span> build-master</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="ex">ccmake</span> ..</span></code></pre></div>
<p>When you run ccmake (note the .. is required!), a menu will appear where you can configure various aspects of the build. If you want QGIS to have debugging capabilities then set CMAKE_BUILD_TYPE to Debug. If you do not have root access or do not want to overwrite existing QGIS installs (by your package manager for example), set the CMAKE_INSTALL_PREFIX to somewhere you have write access to (I usually use ${HOME}/apps). Now press ‘c’ to configure, ‘e’ to dismiss any error messages that may appear. and ‘g’ to generate the make files. Note that sometimes ‘c’ needs to be pressed several times before the ‘g’ option becomes available. After the ‘g’ generation is complete, press ‘q’ to exit the ccmake interactive dialog.</p>
<p><strong>Warning:</strong> Make sure that your build directory is completely empty when you enter the command. Do never try to “re-use” an existing<strong>Qt5</strong> build directory. If you want to use <code>ccmake</code> or other interactive tools, run the command in the empty build directory once before starting to use the interactive tools.</p>
<p>Now on with the build:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a>    <span class="fu">make</span> -jX</span></code></pre></div>
<p>where X is the number of available cores. Depending on your platform, this can speed up the build time considerably.</p>
<p>Then you can directly run from the build directory:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a>    <span class="ex">./output/bin/qgis</span></span></code></pre></div>
<p>Another option is to install to your system:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a>    <span class="fu">make</span> install</span></code></pre></div>
<p>After that you can try to run QGIS:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a>    <span class="va">$HOME</span><span class="ex">/apps/bin/qgis</span></span></code></pre></div>
<p>If all has worked properly the QGIS application should start up and appear on your screen. If you get the error message “error while loading shared libraries”, execute this command in your shell.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a>    <span class="fu">sudo</span> ldconfig</span></code></pre></div>
<p>If that doesn’t help add the install path to LD_LIBRARY_PATH:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a>    <span class="bu">export</span> <span class="va">LD_LIBRARY_PATH=$LD_LIBRARY_PATH</span>:<span class="va">${HOME}</span>/apps/lib/</span></code></pre></div>
<p>Optionally, if you already know what aspects you want in your custom build then you can skip the interactive ccmake .. part by using the cmake -D option for each aspect, e.g.:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a>    <span class="fu">cmake</span> -D CMAKE_BUILD_TYPE=Debug -D CMAKE_INSTALL_PREFIX=<span class="va">${HOME}</span>/apps ..</span></code></pre></div>
<p>Also, if you want to speed your build times, you can easily do it with ninja, an alternative to make with similar build options.</p>
<p>For example, to configure your build you can do either one of:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1"></a>    <span class="ex">ccmake</span> -G Ninja ..</span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="fu">cmake</span> -G Ninja -D CMAKE_BUILD_TYPE=Debug -D CMAKE_INSTALL_PREFIX=<span class="va">${HOME}</span>/apps ..</span></code></pre></div>
<p>Build and install with ninja:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a>    <span class="ex">ninja</span> (uses all cores by default<span class="kw">;</span> <span class="ex">also</span> supports the above described -jX option)</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="ex">ninja</span> install</span></code></pre></div>
<p>To build even faster, you can build just the targets you need using, for example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a>    <span class="ex">ninja</span> qgis</span>
<span id="cb17-2"><a href="#cb17-2"></a>    <span class="ex">ninja</span> pycore</span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="co"># if it&#39;s on desktop related code only:</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="ex">ninja</span> qgis_desktop</span></code></pre></div>
<h2 id="compiling-with-3d">3.8. Compiling with 3D</h2>
<p>In the cmake, you need to enable:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a>    <span class="va">WITH_3D=</span>True</span></code></pre></div>
<h3 id="compiling-with-3d-on-debian-based-distributions">3.8.1. Compiling with 3D on Debian based distributions</h3>
<p>QGIS 3D requires Qt53DExtras. These headers have been removed from Qt upstream on Debian based distributions. A copy has been made in the QGIS repository in <code>external/qt3dextra-headers</code>. To compile with 3D enabled, you need to add some cmake options:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a>    <span class="va">CMAKE_PREFIX_PATH=</span>{<span class="ex">path</span> to QGIS Git repo}<span class="ex">/external/qt3dextra-headers/cmake</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>    <span class="va">QT5_3DEXTRA_INCLUDE_DIR=</span>{<span class="ex">path</span> to QGIS Git repo}<span class="ex">/external/qt3dextra-headers</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="va">QT5_3DEXTRA_LIBRARY=</span>/usr/lib/x86_64-linux-gnu/libQt53DExtras.so</span></code></pre></div>
<h2 id="building-different-branches">3.9. Building different branches</h2>
<p>By using <code>git worktree</code>, you can switch between different branches to use several sources in parallel, based on the same Git configuration. We recommend you to read the documentation about this Git command:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1"></a>    <span class="fu">git</span> commit</span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="fu">git</span> worktree add ../my_new_functionality</span>
<span id="cb20-3"><a href="#cb20-3"></a>    <span class="bu">cd</span> ../my_new_functionality</span>
<span id="cb20-4"><a href="#cb20-4"></a>    <span class="fu">git</span> fetch qgis/master</span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="fu">git</span> rebase -i qgis/master</span>
<span id="cb20-6"><a href="#cb20-6"></a>    <span class="co"># only keep the commits to be pushed</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>    <span class="fu">git</span> push -u my_own_repo my_new_functionality</span></code></pre></div>
<h2 id="building-debian-packages">3.10. Building Debian packages</h2>
<p>Instead of creating a personal installation as in the previous step you can also create debian package. This is done from the QGIS root directory, where you’ll find a debian directory.</p>
<p>First you need to install the debian packaging tools once:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1"></a>    <span class="ex">apt-get</span> install build-essential</span></code></pre></div>
<p>First you need to create an changelog entry for your distribution. For example for Ubuntu Precise:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1"></a>    <span class="ex">dch</span> -l ~precise --force-distribution --distribution precise <span class="st">&quot;precise build&quot;</span></span></code></pre></div>
<p>The QGIS packages will be created with:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1"></a>    <span class="ex">dpkg-buildpackage</span> -us -uc -b</span></code></pre></div>
<p><strong>Note:</strong> Install <code>devscripts</code> to get <code>dch</code>.</p>
<p><strong>Note:</strong> If <code>dpkg-buildpackage</code> complains about unmet build dependencies you can install them using <code>apt-get</code> and re-run the command.</p>
<p><strong>Note:</strong> If you have <code>libqgis1-dev</code> installed, you need to remove it first using <code>dpkg -r libqgis1-dev</code>. Otherwise <code>dpkg-buildpackage</code> will complain about a build conflict.</p>
<p><strong>Note:</strong> By default tests are run in the process of building and their results are uploaded to http://cdash.orfeo-toolbox.org/index.php?project=QGIS. You can turn the tests off using DEB_BUILD_OPTIONS=nocheck in front of the build command. The upload of results can be avoided with DEB_TEST_TARGET=test.</p>
<p>The packages are created in the parent directory (ie. one level up). Install them using dpkg. E.g.:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1"></a>    <span class="fu">sudo</span> debi</span></code></pre></div>
<h2 id="on-fedora-linux">3.11. On Fedora Linux</h2>
<p>We assume that you have the source code of QGIS ready and created a new subdirectory called <code>build</code> or <code>build-qt5</code> in it.</p>
<h3 id="install-build-dependencies-1">3.11.1. Install build dependencies</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1"></a>    <span class="ex">dnf</span> install qt5-qtbase-private-devel qt5-qtwebkit-devel qt5-qtlocation-devel qt5-qttools-static qca-qt5-devel qca-qt5-ossl qt5-qt3d-devel python3-qt5-devel python3-qscintilla-qt5-devel qscintilla-qt5-devel python3-qscintilla-devel python3-qscintilla-qt5 clang flex bison geos-devel gdal-devel sqlite-devel libspatialite-devel qt5-qtsvg-devel spatialindex-devel expat-devel proj-devel qwt-qt5-devel gsl-devel postgresql-devel cmake python3-future gdal-python3 python3-psycopg2 python3-PyYAML python3-pygments python3-jinja2 python3-OWSLib qca-qt5-ossl qwt-qt5-devel qtkeychain-qt5-devel qwt-devel sip-devel libzip-devel exiv2-devel</span></code></pre></div>
<p>To build QGIS server additional dependencies are required:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1"></a>    <span class="ex">dnf</span> install fcgi-devel</span></code></pre></div>
<p>Make sure that your build directory is completely empty when you enter the following command. Do never try to “re-use” an existing Qt5 build directory. If you want to use <code>ccmake</code> or other interactive tools, run the following command in the empty build directory once before starting to use the interactive tools.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1"></a>    <span class="fu">cmake</span> ..</span></code></pre></div>
<p>If everything went OK you can finally start to compile. (As usual append a -jX where X is the number of available cores option to make to speed up your build process)</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1"></a>    <span class="fu">make</span></span></code></pre></div>
<p>Run from the build directory</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1"></a>    <span class="ex">./output/bin/qgis</span></span></code></pre></div>
<p>Or install to your system</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1"></a>    <span class="fu">make</span> install</span></code></pre></div>
<h3 id="suggested-system-tweaks">3.11.2. Suggested system tweaks</h3>
<p>By default Fedora disables debugging calls from Qt applications. This prevents the useful debug output which is normally printed when running the unit tests.</p>
<p>To enable debug prints for the current user, execute:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1"></a>    <span class="fu">cat</span> <span class="op">&gt;</span> ~/.config/QtProject/qtlogging.ini <span class="op">&lt;&lt; EOL</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>    [Rules]</span>
<span id="cb31-3"><a href="#cb31-3"></a>    default.debug=true</span>
<span id="cb31-4"><a href="#cb31-4"></a>    EOL</span></code></pre></div>
<h1 id="building-on-windows">4. Building on Windows</h1>
<h2 id="building-with-microsoft-visual-studio">4.1. Building with Microsoft Visual Studio</h2>
<p>This section describes how to build QGIS using Visual Studio (MSVC) 2015 on Windows. This is currently also how the binary QGIS packages are made (earlier versions used MinGW).</p>
<p>This section describes the setup required to allow Visual Studio to be used to build QGIS.</p>
<h3 id="visual-studio-2015-community-edition">4.1.1. Visual Studio 2015 Community Edition</h3>
<p>The free (as in free beer) Community installer is available under:</p>
<blockquote>
<p>http://download.microsoft.com/download/D/2/3/D23F4D0F-BA2D-4600-8725-6CCECEA05196/vs_community_ENU.exe</p>
</blockquote>
<p>Select “Custom” install and add the following packages:</p>
<ul>
<li>“Common Tools for Visual C++ 2015” under “Visual C++”</li>
<li>“Tools (1.4.1) and Windows 10 SDK (10.0.14393)” under “Universal Windows App Development Tools”.</li>
</ul>
<h3 id="other-tools-and-dependencies">4.1.2. Other tools and dependencies</h3>
<p>Download and install following packages:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Tool</th>
<th>Website</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CMake</td>
<td>https://cmake.org/files/v3.12/cmake-3.12.3-win64-x64.msi</td>
</tr>
<tr class="even">
<td>GNU flex, GNU bison and GIT</td>
<td>http://cygwin.com/setup-x86.exe (32bit) or http://cygwin.com/setup-x86_64.exe (64bit)</td>
</tr>
<tr class="odd">
<td>OSGeo4W</td>
<td>http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86.exe (32bit) or http://download.osgeo.org/osgeo4w/osgeo4w-setup-x86_64.exe (64bit)</td>
</tr>
<tr class="even">
<td>ninja</td>
<td>https://github.com/ninja-build/ninja/releases/download/v1.7.2/ninja-win.zip</td>
</tr>
</tbody>
</table>
<p>For the QGIS build you need to install following packages from cygwin:</p>
<ul>
<li>bison</li>
<li>flex</li>
<li>git (even if you already have Git for Windows installed)</li>
</ul>
<p>and from OSGeo4W (select<em>Advanced Install</em>):</p>
<ul>
<li>qgis-dev-deps</li>
</ul>
<p>This will also select packages the above packages depend on.</p>
If you install other packages, this might cause issues. Particularly, make sure <strong>not</strong> to install the msinttypes package. It installs a stdint.h file in OSGeo4W[64]
<p>, that conflicts with Visual Studio own stdint.h, which for example breaks the build of the virtual layer provider.</p>
<p>Earlier versions of this document also covered how to build all above dependencies. If you’re interested in that, check the history of this page in the Wiki or the SVN repository.</p>
<p>ninja: copy ninja.exe to C:4W64<br />
</p>
<h3 id="clone-the-qgis-source-code">4.1.3. Clone the QGIS Source Code</h3>
<p>Choose a directory to store the QGIS source code. For example, to put it in the OSGeo4W64 install, navigate there:</p>
<pre class="cmd"><code>    cd C:\OSGeo4W64</code></pre>
<p>This directory will be assumed for all instructions that follow.</p>
<p>On the command prompt clone the QGIS source from git to the source directory <code>QGIS</code>:</p>
<pre class="cmd"><code>    git clone git://github.com/qgis/QGIS.git</code></pre>
<p>This requires Git. If you have Git for Windows on your PATH already, you can do this from a normal command prompt. If you do not, you can use the Git package that was installed as part of Cygwin by opening a Cygwin[64] Terminal</p>
<p>And, to avoid Git in Windows reporting changes to files not actually modified:</p>
<pre class="cmd"><code>    cd QGIS
    git config core.filemode false</code></pre>
<h3 id="setting-up-the-visual-studio-project-with-cmake">4.1.4. Setting up the Visual Studio project with CMake</h3>
<p>/! Consider this section as example. It tends to outdate, when OSGeo4W and SDKs move on. <code>ms-windows/osgeo4w/package-nightly.cmd</code> is used for the nightly builds and constantly updated and hence might contain necessary updates that are not yet reflected here.</p>
<p>To start a command prompt with an environment that both has the VC++ and the OSGeo4W variables create the following batch file (assuming the above packages were installed in the default locations):</p>
<pre class="cmd"><code>    @echo off
    call C:\OSGeo4W64\QGIS\ms-windows\osgeo4w\msvc-env.bat x86_64
    @cmd</code></pre>
<p>Save the batch file as <code>C:\OSGeo4W64\OSGeo4W-dev.bat</code> and run it.</p>
<p>Using configonly.bat to create the MSVC solution file: We will be using the file <code>ms-windows/osgeo4w/configonly.bat</code> to create an MSVC solution file. There are two supported CMake generators for creating a solution file: Ninja, and native MSVC. The advantage of using native MSVC solution is that you can find the root of build problems much more easily. configonly.bat is meant to create a configured build directory with a MSVC solution file:</p>
<pre class="cmd"><code>    cd C:\OSGeo4W64\QGIS\ms-windows\osgeo4w
    configonly.bat</code></pre>
<p>Compiling QGIS with MSVC: We will need to run MSVC with all the environment variables set, thus we will run it as follows: Run the batch file OSGeo4W-dev.bat you created before. On the command prompt run <code>call gdal-dev-env.bat</code> to add the release gdal and proj libraries to your PATH. On the command prompt run <code>devenv</code> to open MSVC. From MSVC, open the solution file <code>C:\OSGeo4W64\QGIS\ms-windows\osgeo4w\build-qgis-test-x86_64\qgis.sln</code> Try to build the solution (go grab a cup of tea, it may take a while). If it fails, run it again and again until there are (hopefully) no errors.</p>
<p>Running QGIS from within MSVC: Edit the properties of the project ALL_BUILD: Debugging -&gt; Command -&gt; <code>C:\OSGeo4W64\QGIS\ms-windows\osgeo4w\build-qgis-test-x86_64\output\bin\RelWithDebInfo\qgis.exe</code> Run: Debug -&gt; Start Debugging (F5) or Start Without Debugging (Ctrl+F5) Ignore the “These projects are out of date” message, it appears even if no files were changed.</p>
<p>Old alternative method that might still work using cmake-gui: Create a ‘build’ directory somewhere. This will be where all the build output will be generated.</p>
<p>Now run <code>cmake-gui</code> (still from <code>cmd</code>) and in the<em>Where is the source code:</em> box, browse to the top level QGIS directory.</p>
<p>In the<em>Where to build the binaries:</em> box, browse to the ‘build’ directory you created.</p>
<p>If the path to bison and flex contains blanks, you need to use the short name for the directory (i.e. <code>C:\Program Files</code> should be rewritten to <code>C:\Progra~n</code>, where <code>n</code> is the number as shown in `dir /x C:``).</p>
<p>Verify that the ‘BINDINGS_GLOBAL_INSTALL’ option is not checked, so that python bindings are placed into the output directory when you run the INSTALL target.</p>
<p>Hit <code>Configure</code> to start the configuration and select <code>Visual Studio 9 2008</code> and keep <code>native compilers</code> and click <code>Finish</code>.</p>
<p>The configuration should complete without any further questions and allow you to click <code>Generate</code>.</p>
<p>Now close <code>cmake-gui</code> and continue on the command prompt by starting <code>vcexpress</code>. Use File / Open / Project/Solutions and open the qgis-x.y.z.sln File in your project directory.</p>
<p>Change <code>Solution Configuration</code> from <code>Debug</code> to <code>RelWithDebInfo</code> (Release with Debug Info) or <code>Release</code> before you build QGIS using the ALL_BUILD target (otherwise you need debug libraries that are not included).</p>
<p>After the build completed you should install QGIS using the INSTALL target.</p>
<p>Install QGIS by building the INSTALL project. By default this will install to c:Files<version> (this can be changed by changing the CMAKE_INSTALL_PREFIX variable in cmake-gui).</p>
<p>You will also either need to add all the dependency DLLs to the QGIS install directory or add their respective directories to your PATH.</p>
<h3 id="packaging">4.1.5. Packaging</h3>
<p>To create a standalone installer there is a perl script named ‘creatensis.pl’ in ‘qgis/ms-windows/osgeo4w’. It downloads all required packages from OSGeo4W and repackages them into an installer using NSIS.</p>
<p>The script can be run on both Windows and Linux.</p>
<p>On Debian/Ubuntu you can just install the ‘nsis’ package.</p>
<p>NSIS for Windows can be downloaded at:</p>
<blockquote>
<p>http://nsis.sourceforge.net</p>
</blockquote>
<p>And Perl for Windows (including other requirements like ‘wget’, ‘unzip’, ‘tar’ and ‘bzip2’) is available at:</p>
<blockquote>
<p>http://cygwin.com</p>
</blockquote>
<h3 id="packaging-your-own-build-of-qgis">4.1.6. Packaging your own build of QGIS</h3>
<p>Assuming you have completed the above packaging step, if you want to include your own hand built QGIS executables, you need to copy them in from your windows installation into the ms-windows file tree created by the creatensis script.</p>
<pre class="cmd"><code>    cd ms-windows/
    rm -rf osgeo4w/unpacked/apps/qgis/*
    cp -r /tmp/qgis1.7.0/* osgeo4w/unpacked/apps/qgis/</code></pre>
<p>Now create a package.</p>
<pre class="cmd"><code>    ./quickpackage.sh</code></pre>
<p>After this you should now have a nsis installer containing your own build of QGIS and all dependencies needed to run it on a windows machine.</p>
<h3 id="osgeo4w-packaging">4.1.7. Osgeo4w packaging</h3>
<p>The actual packaging process is currently not documented, for now please take a look at:</p>
<blockquote>
<p>ms-windows/osgeo4w/package.cmd</p>
</blockquote>
<h2 id="building-using-mingw">4.2. Building using MinGW</h2>
<p><strong>Note:</strong> This section might be outdated as nowadays Visual C++ is use to build the “official” packages.</p>
<p><strong>Note:</strong> For a detailed account of building all the dependencies yourself you can visit Marco Pasetti’s website here:</p>
<p>http://www.webalice.it/marco.pasetti/qgis+grass/BuildFromSource.html</p>
<p>Read on to use the simplified approach with pre-built libraries…</p>
<h3 id="msys">4.2.1. MSYS</h3>
<p>MSYS provides a unix style build environment under windows. We have created a zip archive that contains just about all dependencies.</p>
<p>Get this:</p>
<p>http://download.osgeo.org/qgis/win32/msys.zip</p>
<p>and unpack to c:</p>
<p>If you wish to prepare your msys environment yourself rather than using our pre-made one, detailed instructions are provided elsewhere in this document.</p>
<h3 id="qt">4.2.2. Qt</h3>
<p>Download Qt opensource precompiled edition exe and install (including the download and install of mingw) from here:</p>
<p>http://qt.nokia.com/downloads/</p>
<p>When the installer will ask for MinGW, you don’t need to download and install it, just point the installer to c:</p>
<p>When Qt installation is complete:</p>
<p>Edit C:\5.9.1.bat and add the following lines:</p>
<pre class="cmd"><code>    set PATH=%PATH%;C:\msys\local\bin;c:\msys\local\lib
    set PATH=%PATH%;&quot;C:\Program Files\Subversion\bin&quot;</code></pre>
<p>I suggest you also add C:\5.9.1 to your Environment Variables Path in the windows system preferences.</p>
<p>If you plan to do some debugging, you’ll need to compile debug version of Qt: C:\5.9.1.bat compile_debug</p>
<p>Note: there is a problem when compiling debug version of Qt 4.7, the script ends with this message “mingw32-make:*** No rule to make target `debug’. Stop.”. To compile the debug version you have to go out of src directory and execute the following command:</p>
<pre class="cmd"><code>    c:\Qt\5.9.1 make</code></pre>
<h3 id="flex-and-bison">4.2.3. Flex and Bison</h3>
<p>Get Flex http://sourceforge.net/project/showfiles.php?group_id=23617&amp;package_id=16424 (the zip bin) and extract it into c:</p>
<h3 id="python">4.2.4. Python</h3>
<p>Follow this section in case you would like to use Python bindings for QGIS. To be able to compile bindings, you need to compile SIP and PyQt5 from sources as their installer doesn’t include some development files which are necessary.</p>
<p>Note that even if you compile without the Python bindings, Python3 is still a necessary dependency for building QGIS.</p>
<h4 id="download-and-install-python---use-windows-installer">4.2.4.1. Download and install Python - use Windows installer</h4>
<p>(It doesn’t matter to what folder you’ll install it)</p>
<p>http://python.org/download/</p>
<h4 id="download-sip-and-pyqt5-sources">4.2.4.2. Download SIP and PyQt5 sources</h4>
<p>http://www.riverbankcomputing.com/software/sip/download http://www.riverbankcomputing.com/software/pyqt/download</p>
<p>Extract each of the above zip files in a temporary directory. Make sure to get versions that match your current Qt installed version.</p>
<h4 id="compile-sip">4.2.4.3. Compile SIP</h4>
<pre class="cmd"><code>    c:\Qt\5.9.1\bin\qtvars.bat
    python configure.py -p win32-g++
    make
    make install</code></pre>
<h4 id="compile-pyqt">4.2.4.4. Compile PyQt</h4>
<pre class="cmd"><code>    c:\Qt\5.9.1\bin\qtvars.bat
    python configure.py
    make
    make install</code></pre>
<h4 id="final-python-notes">4.2.4.5. Final python notes</h4>
<p>You can delete the directories with unpacked SIP and PyQt5 sources after a successful install, they’re not needed anymore.</p>
<h3 id="git">4.2.5. git</h3>
<p>In order to check out QGIS sources from the repository, you need a git client. This installer should work fine:</p>
<p>https://git-scm.com/download/win</p>
<h3 id="cmake">4.2.6. CMake</h3>
<p>CMake is build system used by QGIS. Download it from here:</p>
<p>https://cmake.org/files/v3.9/cmake-3.9.3-win64-x64.msi</p>
<h3 id="qgis">4.2.7. QGIS</h3>
<p>Start a cmd.exe window ( Start -&gt; Run -&gt; cmd.exe ) Create development directory and move into it</p>
<pre class="cmd"><code>    md c:\dev\cpp
    cd c:\dev\cpp</code></pre>
<p>Check out sources from GIT:</p>
<pre><code>git clone git://github.com/qgis/QGIS.git</code></pre>
<h3 id="compiling">4.2.8. Compiling</h3>
<p>As a background read the generic building with CMake notes at the end of this document.</p>
<p>Start a cmd.exe window ( Start -&gt; Run -&gt; cmd.exe ) if you don’t have one already. Add paths to compiler and our MSYS environment:</p>
<pre class="cmd"><code>    c:\Qt\5.9.1\bin\qtvars.bat</code></pre>
<p>For ease of use add c:\5.9.1 to your system path in system properties so you can just type qtvars.bat when you open the cmd console. Create build directory and set it as current directory:</p>
<pre class="cmd"><code>    cd c:\dev\cpp\qgis
    md build
    cd build</code></pre>
<h3 id="configuration">4.2.9. Configuration</h3>
<pre class="cmd"><code>    cmakesetup ..</code></pre>
<p><strong>Note:</strong> You must include the ‘..’ above.</p>
<p>Click ‘Configure’ button. When asked, you should choose ‘MinGW Makefiles’ as generator.</p>
<p>There’s a problem with MinGW Makefiles on Win2K. If you’re compiling on this platform, use ‘MSYS Makefiles’ generator instead.</p>
<p>All dependencies should be picked up automatically, if you have set up the Paths correctly. The only thing you need to change is the installation destination (CMAKE_INSTALL_PREFIX) and/or set ‘Debug’.</p>
<p>For compatibility with NSIS packaging scripts I recommend to leave the install prefix to its default c:files<br />
</p>
<p>When configuration is done, click ‘OK’ to exit the setup utility.</p>
<h3 id="compilation-and-installation">4.2.10. Compilation and installation</h3>
<pre class="cmd"><code>     make make install</code></pre>
<h3 id="run-qgis.exe-from-the-directory-where-its-installed-cmake_install_prefix">4.2.11. Run qgis.exe from the directory where it’s installed (CMAKE_INSTALL_PREFIX)</h3>
<p>Make sure to copy all .dll:s needed to the same directory as the qgis.exe binary is installed to, if not already done so, otherwise QGIS will complain about missing libraries when started.</p>
<p>A possibility is to run qgis.exe when your path contains c:and c:directories, so the DLLs will be used from that place.</p>
<h3 id="create-the-installation-package-optional">4.2.12. Create the installation package: (optional)</h3>
<p>Download and install NSIS from (http://nsis.sourceforge.net/Main_Page)</p>
<p>Now using windows explorer, enter the win_build directory in your QGIS source tree. Read the READMEfile there and follow the instructions. Next right click on qgis.nsi and choose the option ‘Compile NSIS Script’.</p>
<h2 id="creation-of-msys-environment-for-compilation-of-qgis">4.3. Creation of MSYS environment for compilation of QGIS</h2>
<h3 id="initial-setup">4.3.1. Initial setup</h3>
<h4 id="msys-1">4.3.1.1. MSYS</h4>
<p>This is the environment that supplies many utilities from UNIX world in Windows and is needed by many dependencies to be able to compile.</p>
<p>Download from here:</p>
<blockquote>
<p>http://puzzle.dl.sourceforge.net/sourceforge/mingw/MSYS-1.0.11-2004.04.30-1.exe</p>
</blockquote>
<p>Install to <code>c:\msys</code></p>
<p>All stuff we’re going to compile is going to get to this directory (resp. its subdirs).</p>
<h4 id="mingw">4.3.1.2. MinGW</h4>
<p>Download from here:</p>
<blockquote>
<p>http://puzzle.dl.sourceforge.net/sourceforge/mingw/MinGW-5.1.3.exe</p>
</blockquote>
<p>Install to <code>c:\msys\mingw</code></p>
<p>It suffices to download and install only <code>g++</code> and <code>mingw-make</code> components.</p>
<h4 id="flex-and-bison-1">4.3.1.3. Flex and Bison</h4>
<p>Flex and Bison are tools for generation of parsers, they’re needed for GRASS and also QGIS compilation.</p>
<p>Download the following packages:</p>
<blockquote>
<p>http://gnuwin32.sourceforge.net/downlinks/flex-bin-zip.php http://gnuwin32.sourceforge.net/downlinks/bison-bin-zip.php http://gnuwin32.sourceforge.net/downlinks/bison-dep-zip.php</p>
</blockquote>
<p>Unpack them all to <code>c:\msys\local</code></p>
<h3 id="installing-dependencies">4.3.2. Installing dependencies</h3>
<h4 id="getting-ready">4.3.2.1. Getting ready</h4>
<p>Paul Kelly did a great job and prepared a package of precompiled libraries for GRASS. The package currently includes:</p>
<ul>
<li>zlib-1.2.3</li>
<li>libpng-1.2.16-noconfig</li>
<li>xdr-4.0-mingw2</li>
<li>freetype-2.3.4</li>
<li>fftw-2.1.5</li>
<li>PDCurses-3.1</li>
<li>proj-4.5.0</li>
<li>gdal-1.4.1</li>
</ul>
<p>It’s available for download here:</p>
<blockquote>
<p>http://www.stjohnspoint.co.uk/grass/wingrass-extralibs.tar.gz</p>
</blockquote>
<p>Moreover he also left the notes how to compile it (for those interested):</p>
<blockquote>
<p>http://www.stjohnspoint.co.uk/grass/README.extralibs</p>
</blockquote>
<p>Unpack the whole package to <code>c:\msys\local</code></p>
<h4 id="grass">4.3.2.2. GRASS</h4>
<p>Grab sources from CVS or use a weekly snapshot, see:</p>
<blockquote>
<p>http://grass.itc.it/devel/cvs.php</p>
</blockquote>
<p>In MSYS console go to the directory where you’ve unpacked or checked out sources (e.g. <code>c:\msys\local\src\grass-6.3.cvs</code>)</p>
<p>Run these commands:</p>
<pre class="cmd"><code>    export PATH=&quot;/usr/local/bin:/usr/local/lib:$PATH&quot;
    ./configure --prefix=/usr/local --bindir=/usr/local --with-includes=/usr/local/include --with-libs=/usr/local/lib --with-cxx --without-jpeg \
    --without-tiff --with-postgres=yes --with-postgres-includes=/local/pgsql/include --with-pgsql-libs=/local/pgsql/lib --with-opengl=windows --with-fftw \
    --with-freetype --with-freetype-includes=/mingw/include/freetype2 --without-x --without-tcltk --enable-x11=no --enable-shared=yes \
    --with-proj-share=/usr/local/share/proj
    make
    make install</code></pre>
<p>It should get installed to <code>c:\msys\local\grass-6.3.cvs</code></p>
<p>By the way, these pages might be useful:</p>
<ul>
<li>http://grass.gdf-hannover.de/wiki/WinGRASS_Current_Status</li>
<li>http://geni.ath.cx/grass.html</li>
</ul>
<h4 id="geos">4.3.2.3. GEOS</h4>
<p>Download the sources:</p>
<blockquote>
<p>http://geos.refractions.net/geos-2.2.3.tar.bz2</p>
</blockquote>
<p>Unpack to e.g. <code>c:\msys\local\src</code></p>
<p>To compile, I had to patch the sources: in file <code>source/headers/timeval.h</code> line 13. Change it from:</p>
<pre><code>#ifdef _WIN32</code></pre>
<p>to:</p>
<pre><code>#if defined(_WIN32) &amp;&amp; defined(_MSC_VER)</code></pre>
<p>Now, in MSYS console, go to the source directory and run:</p>
<pre class="cmd"><code>    ./configure --prefix=/usr/local
    make
    make install</code></pre>
<h4 id="sqlite">4.3.2.4. SQLITE</h4>
<p>You can use precompiled DLL, no need to compile from source:</p>
<p>Download this archive:</p>
<blockquote>
<p>http://www.sqlite.org/sqlitedll-3_3_17.zip</p>
</blockquote>
<p>and copy sqlite3.dll from it to <code>c:\msys\local\lib</code></p>
<p>Then download this archive:</p>
<blockquote>
<p>http://www.sqlite.org/sqlite-source-3_3_17.zip</p>
</blockquote>
<p>and copy sqlite3.h to <code>c:\msys\local\include</code></p>
<h4 id="gsl">4.3.2.5. GSL</h4>
<p>Download sources:</p>
<blockquote>
<p>ftp://ftp.gnu.org/gnu/gsl/gsl-1.9.tar.gz</p>
</blockquote>
<p>Unpack to <code>c:\msys\local\src</code></p>
<p>Run from MSYS console in the source directory:</p>
<pre class="cmd"><code>    ./configure
    make
    make install</code></pre>
<h4 id="expat">4.3.2.6. EXPAT</h4>
<p>Download sources:</p>
<blockquote>
<p>http://dfn.dl.sourceforge.net/sourceforge/expat/expat-2.0.0.tar.gz</p>
</blockquote>
<p>Unpack to <code>c:\msys\local\src</code></p>
<p>Run from MSYS console in the source directory:</p>
<pre class="cmd"><code>    ./configure
    make
    make install</code></pre>
<h4 id="postgres">4.3.2.7. POSTGRES</h4>
<p>We’re going to use precompiled binaries. Use the link below for download:</p>
<blockquote>
<p>http://wwwmaster.postgresql.org/download/mirrors-ftp?file=%2Fbinary%2Fv8.2.4%2Fwin32%2Fpostgresql-8.2.4-1-binaries-no-installer.zip</p>
</blockquote>
<p>copy contents of pgsql directory from the archive to <code>c:\msys\local</code></p>
<h3 id="cleanup">4.3.3. Cleanup</h3>
<p>We’re done with preparation of MSYS environment. Now you can delete all stuff in <code>c:\msys\local\src</code> - it takes quite a lot of space and it’s not necessary at all.</p>
<h2 id="building-on-linux-with-mxe">4.4. Building on Linux with mxe</h2>
<p>With this approach you can cross build a Windows binary on Linux using MXE (M cross environment). You can find the build script and a README.md file in the ms-windows/mxe directory.</p>
<p>For now, Python buildings cannot be built with mxe.</p>
<h3 id="building-with-docker">4.4.1. Building with Docker</h3>
<p>This is the simplest way, but you need to have Docker installed on your system.</p>
<p>You can use a Docker image to cross build QGIS by calling the script ms-windows/mxe/build.sh from the root directory of QGIS repository.</p>
<p>=== Building without Docker ====</p>
<p>This requires to install mxe toolchain on your system and build all dependencies by yourself.</p>
<h4 id="initial-setup-1">4.4.1.1. Initial setup</h4>
<p>Please follow the instructions on mxe website to setup your building toolchain http://mxe.cc/, take note of the path where you have installed mxe.</p>
<h4 id="building-the-dependencies">4.4.1.2. Building the dependencies</h4>
<p>Please see README.md under ms-windows/mxe for detailed instructions and for the list of dependencies that need to be built in mxe before attempting to build QGIS.</p>
<h4 id="cross-building-qgis">4.4.1.3. Cross-Building QGIS</h4>
<p>Edit the build-mxe.sh script and optionally adjust the path where your mxe installation is located, you can also change the build and release directories.</p>
<h3 id="testing-qgis">4.4.2. Testing QGIS</h3>
<p>Copy and unzip on the Windows machine package produced by the build and launch the qgis binary: no installation is required.</p>
<h1 id="building-on-macos-x">5. Building on MacOS X</h1>
<p>If you want to test QGIS, easiest option is to download and install all-in-one self-containing bundle directly from</p>
<p>https://qgis.org/downloads/macos</p>
<p>On the other hand, if you want to build or develop QGIS on your own, you need a set of dependencies and tools. These instructions will use the same set of dependencies that are used for all-in-one QGIS bundle, but you can build QGIS with Homebrew, MacPorts or Conda dependencies too.</p>
<p>https://github.com/qgis/QGIS-Mac-Packager</p>
<p>Included are notes for building on latest Mac OS X with latest updates installed. The build uses clang compiler.</p>
<p>Parallel Compilation: On multiprocessor/multicore Macs, it’s possible to speed up compilation, but it’s not automatic. Whenever you type “make” (but NOT “make install”), instead type:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1"></a>    <span class="fu">make</span> -j [#cpus]</span></code></pre></div>
<p>Replace [#cpus] with the number of cores and/or processors your Mac has. To find out how many CPUs you have available, run the following in Terminal:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1"></a>    <span class="ex">/usr/sbin/sysctl</span> -n hw.ncpu</span></code></pre></div>
<h2 id="install-developer-tools">5.1. Install Developer Tools</h2>
<p>Developer tools are not a part of a standard OS X installation. As minimum you require command line tools</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1"></a>    <span class="fu">sudo</span> xcode-select --install</span></code></pre></div>
<p>but installation of Xcode from the App Store is recommended too.</p>
<h2 id="install-cmake-and-other-build-tools">5.2. Install CMake and other build tools</h2>
<p>For example install Homebrew</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1"></a>    <span class="ex">/bin/bash</span> -c <span class="st">&quot;</span><span class="va">$(</span><span class="ex">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh<span class="va">)</span><span class="st">&quot;</span></span></code></pre></div>
<p>and these development/build tools</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1"></a>    <span class="ex">brew</span> install git</span>
<span id="cb59-2"><a href="#cb59-2"></a>    <span class="ex">brew</span> install cmake</span>
<span id="cb59-3"><a href="#cb59-3"></a>    <span class="ex">brew</span> install ninja</span>
<span id="cb59-4"><a href="#cb59-4"></a>    <span class="ex">brew</span> install pkg-config</span>
<span id="cb59-5"><a href="#cb59-5"></a>    <span class="ex">brew</span> install wget</span>
<span id="cb59-6"><a href="#cb59-6"></a>    <span class="ex">brew</span> install bash-completion</span>
<span id="cb59-7"><a href="#cb59-7"></a>    <span class="ex">brew</span> install curl</span>
<span id="cb59-8"><a href="#cb59-8"></a>    <span class="ex">brew</span> install gnu-sed</span>
<span id="cb59-9"><a href="#cb59-9"></a>    <span class="ex">brew</span> install coreutils</span>
<span id="cb59-10"><a href="#cb59-10"></a>    <span class="ex">brew</span> install ccache</span>
<span id="cb59-11"><a href="#cb59-11"></a>    <span class="ex">brew</span> install libtool</span>
<span id="cb59-12"><a href="#cb59-12"></a>    <span class="ex">brew</span> install astyle</span>
<span id="cb59-13"><a href="#cb59-13"></a>    <span class="ex">brew</span> install help2man</span>
<span id="cb59-14"><a href="#cb59-14"></a>    <span class="ex">brew</span> install autoconf</span>
<span id="cb59-15"><a href="#cb59-15"></a>    <span class="ex">brew</span> install automake</span>
<span id="cb59-16"><a href="#cb59-16"></a>    <span class="ex">brew</span> install txt2tags</span></code></pre></div>
<p>if you have these tools installed from MacPorts or Conda, it is the same, but we will need to be able to run <code>cmake</code> and others from Terminal in the following steps</p>
<h2 id="install-qt5-and-qgis-deps">5.3. Install Qt5 and QGIS-Deps</h2>
<p>To build QGIS, we need Qt5 and FOSS dependencies on hand. The Qt5 version ideally should match the version that was used to build dependency package.</p>
<p>Download the latest QGIS-Deps install script, qt package and QGIS-Deps packages from</p>
<p>https://qgis.org/downloads/macos/deps</p>
<p>You should have one bash script and two tar archive in your download folder. Run the install script to install Qt and QGIS-Deps to <code>/opt/</code> area. You need root privileges or have write access to <code>/opt/Qt</code> and <code>/opt/QGIS</code>.</p>
<p>Alternatively you can download and install Qt Open Source for MacOS from the</p>
<p>https://www.qt.io/</p>
<p>in the same version as referenced in the install script. It must be installed in <code>/opt/Qt</code></p>
<p>Note that the QGIS-Deps package is not yet signed, so you may need to add Terminal to System Preferences -&gt; Security &amp; Privacy -&gt; Privacy -&gt; Developer Tools or manually accept usage of the libraries when asked by system.</p>
<h2 id="qgis-source">5.4. QGIS source</h2>
<p>Unzip the QGIS source to a working folder of your choice. If you are reading this from the source, you’ve already done this.</p>
<p>If you want to experiment with the latest development sources, go to the github QGIS project page:</p>
<p>http://github.com/qgis/QGIS</p>
<p>It should default to the master branch. Click the Downloads button and select Download .tar.gz. Double-click the tarball to unzip it.</p>
<p><em>Alternatively</em>, use git and clone the repository by</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1"></a>    <span class="fu">git</span> clone git://github.com/qgis/QGIS.git</span></code></pre></div>
<h2 id="configure-the-build">5.5. Configure the build</h2>
<p>CMake supports out of source build so we will create a ‘build’ dir for the build process. OS X uses ${HOME}/Applications as a standard user app folder (it gives it the system app folder icon). If you have the correct permissions you may want to build straight into your /Applications folder. The instructions below assume you are building into a ${HOME}/Applications directory.</p>
<p>In a Terminal cd to the qgis source folder previously downloaded, then:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1"></a>    <span class="bu">cd</span> ..</span>
<span id="cb61-2"><a href="#cb61-2"></a>    <span class="fu">mkdir</span> build</span>
<span id="cb61-3"><a href="#cb61-3"></a>    <span class="bu">cd</span> build</span>
<span id="cb61-4"><a href="#cb61-4"></a></span>
<span id="cb61-5"><a href="#cb61-5"></a>    <span class="va">QGIS_DEPS_VERSION=</span>0.3.0;<span class="kw">\</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>    <span class="va">QT_VERSION=</span>5.14.1;<span class="kw">\</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>    <span class="va">PATH=</span>/opt/QGIS/qgis-deps-<span class="va">${QGIS_DEPS_VERSION}</span>/stage/bin:<span class="va">$PATH</span>;<span class="kw">\</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>    <span class="fu">cmake</span> \</span>
<span id="cb61-9"><a href="#cb61-9"></a>      -DCMAKE_INSTALL_PREFIX=~/Applications \</span>
<span id="cb61-10"><a href="#cb61-10"></a>      -DCMAKE_BUILD_TYPE=Release \</span>
<span id="cb61-11"><a href="#cb61-11"></a>      -DQGIS_MAC_DEPS_DIR=/opt/QGIS/qgis-deps-<span class="va">${QGIS_DEPS_VERSION}</span>/stage \</span>
<span id="cb61-12"><a href="#cb61-12"></a>      -DCMAKE_PREFIX_PATH=/opt/Qt/<span class="va">${QT_VERSION}</span>/clang_64 \</span>
<span id="cb61-13"><a href="#cb61-13"></a>      ../QGIS</span></code></pre></div>
<p>Note: Don’t forget the <code>../QGIS</code> on the last line, which tells CMake to look for the source files.</p>
<p>Note: Double check on the screen output that all libraries are picked from QGIS-Deps <code>/opt/QGIS</code> and not from system <code>/usr/lib</code> or Homebrew’s <code>/usr/local/</code> or system Frameworks <code>/Library/Frameworks/</code>. Especially check Proj, GDAL, sqlite3 and Python paths.</p>
<p>After the initial Terminal configure, you can use ccmake to make further changes:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1"></a>    <span class="bu">cd</span> build</span>
<span id="cb62-2"><a href="#cb62-2"></a>    <span class="ex">ccmake</span> ..</span></code></pre></div>
<h2 id="building">5.6. Building</h2>
<p>Now we can start the build process (remember the parallel compilation note at the beginning, this is a good place to use it, if you can):</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1"></a>    <span class="fu">make</span> -j [#cpus]</span></code></pre></div>
<p>Now you can run the QGIS from build directory by <code>./output/bin/QGIS.app/Contents/MacOS/QGIS</code></p>
<p>If all built without errors you can then install it:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1"></a>    <span class="fu">make</span> install</span></code></pre></div>
<p>or, for an /Applications build:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1"></a>    <span class="fu">sudo</span> make install</span></code></pre></div>
<p>For running the installed QGIS, you need to keep the dependencies in <code>/opt/</code> folder in place. If you want to create bundle that runs without these dependencies, please read the documentation in project</p>
<p>https://github.com/qgis/QGIS-Mac-Packager</p>
<h1 id="setting-up-the-wcs-test-server-on-gnulinux">6. Setting up the WCS test server on GNU/Linux</h1>
<p><strong>Requires:</strong> Ubuntu / Debian derived distro</p>
<p>These notes are for Ubuntu - other versions and Debian derived distros may require slight variations in package names.</p>
<h2 id="preparation">6.1. Preparation</h2>
<p>Note the git repo below will change to the default QGIS repo once this work is integrated into master.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1"></a>  <span class="fu">git</span> remote add blazek git://github.com/blazek/Quantum-GIS.git</span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">git</span> fetch blazek</span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">git</span> branch --track wcs2 blazek/wcs2</span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">git</span> checkout wcs2</span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="bu">cd</span> /var/www/</span>
<span id="cb66-6"><a href="#cb66-6"></a>  <span class="fu">sudo</span> mkdir wcs</span>
<span id="cb66-7"><a href="#cb66-7"></a>  <span class="fu">sudo</span> chown timlinux wcs</span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="bu">cd</span> wcs/</span>
<span id="cb66-9"><a href="#cb66-9"></a>  <span class="fu">mkdir</span> cgi-bin</span>
<span id="cb66-10"><a href="#cb66-10"></a>  <span class="bu">cd</span> cgi-bin/</span></code></pre></div>
<h2 id="setup-mapserver">6.2. Setup mapserver</h2>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1"></a>    <span class="fu">sudo</span> apt-get install cgi-mapserver</span></code></pre></div>
<p>Set the contents of cgi-bin/wcstest-1.9.0 to:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1"></a>      <span class="co">#! /bin/sh</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>      <span class="va">MS_MAPFILE=</span>/var/www/wcs/testdata/qgis-1.9.0/raster/wcs.map</span>
<span id="cb68-3"><a href="#cb68-3"></a>      <span class="bu">export</span> <span class="va">MS_MAPFILE</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>      <span class="ex">/usr/lib/cgi-bin/mapserv</span></span></code></pre></div>
<p>Then do:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb69-1"><a href="#cb69-1"></a>      <span class="fu">chmod</span> +x cgi-bin/wcstest-1.9.0</span>
<span id="cb69-2"><a href="#cb69-2"></a>      <span class="fu">mkdir</span> -p /var/www/wcs/testdata/qgis-1.9.0/raster/</span>
<span id="cb69-3"><a href="#cb69-3"></a>      <span class="bu">cd</span> /var/www/wcs/testdata/qgis-1.9.0/raster/</span>
<span id="cb69-4"><a href="#cb69-4"></a>      <span class="fu">cp</span> -r /home/timlinux/QGIS/tests/testdata/raster/* .</span></code></pre></div>
<p>Edit wcs.map and set the shapepath to this:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1"></a>      <span class="ex">SHAPEPATH</span> <span class="st">&quot;/var/www/wcs/testdata/qgis-1.9.0/raster&quot;</span></span></code></pre></div>
<p>Then create /var/www/wcs/7-wcs.qgis.org.conf setting the contents to this:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1"></a>      <span class="op">&lt;</span><span class="ex">VirtualHost*</span>:<span class="op">80&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>      <span class="ex">ServerName</span> wcs.qgis.org</span>
<span id="cb71-3"><a href="#cb71-3"></a>      <span class="ex">ServerAdmin</span> tim@linfiniti.com</span>
<span id="cb71-4"><a href="#cb71-4"></a></span>
<span id="cb71-5"><a href="#cb71-5"></a>      <span class="ex">LogLevel</span> warn</span>
<span id="cb71-6"><a href="#cb71-6"></a>      <span class="ex">LogFormat</span> <span class="st">&quot;%h %l %u %t </span><span class="dt">\&quot;</span><span class="st">%r</span><span class="dt">\&quot;</span><span class="st"> %&gt;s %b </span><span class="dt">\&quot;</span><span class="st">%{Referer}i</span><span class="dt">\&quot;</span><span class="st"> </span><span class="dt">\&quot;</span><span class="st">%{User-Agent}i</span><span class="dt">\&quot;</span><span class="st"> </span><span class="dt">\&quot;</span><span class="st">%{forensic-id}n</span><span class="dt">\&quot;</span><span class="st">&quot;</span> combined</span>
<span id="cb71-7"><a href="#cb71-7"></a>      <span class="ex">CustomLog</span> /var/log/apache2/wcs_qgis.org/access.log combined</span>
<span id="cb71-8"><a href="#cb71-8"></a>      <span class="ex">ErrorLog</span> /var/log/apache2/wcs_qgis.org/error.log</span>
<span id="cb71-9"><a href="#cb71-9"></a></span>
<span id="cb71-10"><a href="#cb71-10"></a>      <span class="ex">DocumentRoot</span> /var/www/wcs/html</span>
<span id="cb71-11"><a href="#cb71-11"></a></span>
<span id="cb71-12"><a href="#cb71-12"></a>      <span class="ex">ScriptAlias</span> /cgi-bin/ /var/www/wcs/cgi-bin/</span>
<span id="cb71-13"><a href="#cb71-13"></a>      <span class="op">&lt;</span><span class="ex">Directory</span> <span class="st">&quot;/var/www/wcs/cgi-bin&quot;</span><span class="op">&gt;</span></span>
<span id="cb71-14"><a href="#cb71-14"></a>            <span class="ex">AllowOverride</span> None</span>
<span id="cb71-15"><a href="#cb71-15"></a>            <span class="ex">Options</span> +ExecCGI -MultiViews +SymLinksIfOwnerMatch</span>
<span id="cb71-16"><a href="#cb71-16"></a>            <span class="ex">Order</span> allow,deny</span>
<span id="cb71-17"><a href="#cb71-17"></a>            <span class="ex">Allow</span> from all</span>
<span id="cb71-18"><a href="#cb71-18"></a>      <span class="op">&lt;</span>/<span class="ex">Directory</span><span class="op">&gt;</span></span>
<span id="cb71-19"><a href="#cb71-19"></a></span>
<span id="cb71-20"><a href="#cb71-20"></a>      <span class="ex">RewriteEngine</span> on</span>
<span id="cb71-21"><a href="#cb71-21"></a>      <span class="ex">RewriteRule</span> /1.9.0/wcs /cgi-bin/wcstest-1.9.0 [PT]</span>
<span id="cb71-22"><a href="#cb71-22"></a></span>
<span id="cb71-23"><a href="#cb71-23"></a>      <span class="op">&lt;</span>/<span class="ex">VirtualHost</span><span class="op">&gt;</span></span></code></pre></div>
<h2 id="create-a-home-page">6.3. Create a home page</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1"></a>      <span class="fu">mkdir</span> html</span>
<span id="cb72-2"><a href="#cb72-2"></a>      <span class="ex">vim</span> html/index.html</span></code></pre></div>
<p>Set the contents to:</p>
<pre><code>  This is the test platform for QGIS&#39; wcs client. You can use these services
  from QGIS directly (to try out WCS for example) by pointing your QGIS to:
  http://wcs.qgis.org/1.9.0/wcs</code></pre>
<h2 id="now-deploy-it">6.4. Now deploy it</h2>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1"></a>      <span class="fu">sudo</span> mkdir /var/log/apache2/wcs_qgis.org</span>
<span id="cb74-2"><a href="#cb74-2"></a>      <span class="fu">sudo</span> chown www-data /var/log/apache2/wcs_qgis.org</span>
<span id="cb74-3"><a href="#cb74-3"></a>      <span class="bu">cd</span> /etc/apache2/sites-available/</span>
<span id="cb74-4"><a href="#cb74-4"></a>      <span class="fu">sudo</span> ln -s /var/www/wcs/7-wcs.qgis.org.conf .</span>
<span id="cb74-5"><a href="#cb74-5"></a>      <span class="bu">cd</span> /var/www/wcs/</span>
<span id="cb74-6"><a href="#cb74-6"></a>      <span class="fu">sudo</span> a2ensite 7-wcs.qgis.org.conf</span>
<span id="cb74-7"><a href="#cb74-7"></a>      <span class="fu">sudo</span> /etc/init.d/apache2 reload</span></code></pre></div>
<h2 id="debugging">6.5. Debugging</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1"></a>      <span class="fu">sudo</span> tail -f /var/log/apache2/wcs_qgis.org/error.log</span></code></pre></div>
<h1 id="setting-up-a-jenkins-build-server">7. Setting up a Jenkins Build Server</h1>
<p><strong>Assumption:</strong> You know how to make a working build environment and want to deploy it under Jenkins for continuous integration testing now.</p>
<p>These notes are terse, I will expand on them later as the need arises. The procedure is:</p>
<ul>
<li>Install Jenkins and get it configured according to your own preferences</li>
<li>Make sure you have the git, github, junit etc plugins installed. A complete list of the plugins I have installed follows (note that you almost certainly don’t need evey plugin listed here):
<ul>
<li>External Monitor Job Type Plugin</li>
<li>LDAP Plugin</li>
<li>pam-auth</li>
<li>javadoc</li>
<li>ant</li>
<li>Jenkins Subversion Plug-in qq Git Plugin</li>
<li>Maven 2 Project Plugin</li>
<li>Jenkins SLOCCount Plug-in</li>
<li>Jenkins Sounds plugin</li>
<li>Jenkins Translation Assistance plugin</li>
<li>ruby-runtime</li>
<li>Jenkins CVS Plug-in</li>
<li>Coverage/Complexity Scatter Plot PlugIn</li>
<li>Status Monitor Plugin</li>
<li>Git Parameter Plug-In</li>
<li>github-api</li>
<li>GitHub plugin</li>
<li>Jenkins Violations plugin</li>
<li>git-notes Plugin</li>
<li>Twitter plugin</li>
<li>Jenkins Cobertura Plugin</li>
<li>Jenkins Gravatar plugin</li>
<li>Jenkins SSH Slaves plugin</li>
</ul></li>
<li>Create a Job called ‘QGIS’</li>
<li>Use the following options for your job:
<ul>
<li><p>Job Name: QGIS</p></li>
<li><p>Job Type: Build a free-style software project</p></li>
<li><p>Tick enable project based security (you need to elsewhere configure your Jenkins security to per project settings)</p></li>
<li><p>Allow Anonymous user Read and Discover access</p></li>
<li><p>Set the github project to https://github.com/qgis/QGIS/</p></li>
<li><p>Set source code management to Git</p></li>
<li><p>Set repository url to git://github.com/qgis/QGIS.git</p></li>
<li><p>In advanced repository url settings set refspec to :</p>
<p>+refs/heads/master:refs/remotes/origin/master</p></li>
<li><p>Set branch to build to master</p></li>
<li><p>Repository Browser: Auto</p></li>
<li><p>Build triggers: set to Poll SCM and set schedule to <code>*****</code> (polls every minute)</p></li>
<li><p>Build - Execute shell and set shell script to:</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb76-1"><a href="#cb76-1"></a>      <span class="bu">cd</span> build</span>
<span id="cb76-2"><a href="#cb76-2"></a>      <span class="fu">cmake</span> ..</span>
<span id="cb76-3"><a href="#cb76-3"></a>      <span class="ex">xvfb-run</span> --auto-servernum --server-num=1 \</span>
<span id="cb76-4"><a href="#cb76-4"></a>               --server-args=<span class="st">&quot;-screen 0 1024x768x24&quot;</span> \</span>
<span id="cb76-5"><a href="#cb76-5"></a>               make Experimental <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb76-6"><a href="#cb76-6"></a>      <span class="kw">if</span><span class="bu"> [</span> <span class="ot">-f</span> Testing/TAG<span class="bu"> ]</span> ; <span class="kw">then</span></span>
<span id="cb76-7"><a href="#cb76-7"></a>         <span class="ex">xsltproc</span> ../tests/ctest2junix.xsl \</span>
<span id="cb76-8"><a href="#cb76-8"></a>           Testing/<span class="kw">`</span><span class="fu">head</span> -n 1 <span class="op">&lt;</span> Testing/TAG<span class="kw">`</span>/Test.xml <span class="op">&gt;</span> \</span>
<span id="cb76-9"><a href="#cb76-9"></a>           CTestResults.xml</span>
<span id="cb76-10"><a href="#cb76-10"></a>      <span class="kw">fi</span></span></code></pre></div>
<ul>
<li>Add Junit post build action and set ‘Publish Junit test result report’ to: <code>build/CTestResults.xml</code></li>
<li>Email notification: Send separate e-mails to individuals who broke the build</li>
<li>Jenkins sounds - set up sounds for Failure, Success and Unstable.</li>
<li>Save</li>
</ul>
<p>Now open the Job dash board and push something to QGIS and wait a minute to validate automated builds work.</p>
<p><strong>Note:</strong> You will need to log in to the Jenkins user account and go to /var/lib/jenkins/jobs/QGIS/workspace, then make a <code>build</code> directory and run the initial cmake setup and then do test build. This process is the same as described elsewhere in this doc.</p>
<p>I based some of the set up from this nice blog article here:</p>
<p>http://alexott.blogspot.com/2012/03/jenkins-cmakectest.html</p>
<h1 id="debug-output-and-running-tests">8. Debug output and running tests</h1>
<p>If you are interested in seeing embedded debug output, change the following CMake option:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb77-1"><a href="#cb77-1"></a>    <span class="ex">-D</span> CMAKE_BUILD_TYPE=DEBUG (or RELWITHDEBINFO)</span></code></pre></div>
<p>This will flood your terminal or system log with lots of useful output from QgsDebugMsg() calls in source code.</p>
<p>If you would like to run the test suite, you will need to do so from the build directory, as it will not work with the installed/bundled app. First set the CMake option to enable tests:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1"></a>    <span class="ex">-D</span> ENABLE_TESTS=TRUE</span></code></pre></div>
<p>Then run all tests from build directory:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb79-1"><a href="#cb79-1"></a>    <span class="bu">cd</span> build</span>
<span id="cb79-2"><a href="#cb79-2"></a>    <span class="fu">make</span> test</span></code></pre></div>
<p>To run all tests and report to http://cdash.orfeo-toolbox.org/index.php?project=QGIS</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1"></a>    <span class="bu">cd</span> build</span>
<span id="cb80-2"><a href="#cb80-2"></a>    <span class="fu">make</span> Experimental</span></code></pre></div>
<p>You can define the host name reported via ‘make Experimental’ by setting a CMake option:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb81-1"><a href="#cb81-1"></a>    <span class="ex">-D</span> SITE=<span class="st">&quot;my.domain.org&quot;</span></span></code></pre></div>
<p>To run specific test(s) (see ‘man ctest’):</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb82-1"><a href="#cb82-1"></a>    <span class="bu">cd</span> build</span>
<span id="cb82-2"><a href="#cb82-2"></a>    <span class="co"># show listing of tests, without running them</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>    <span class="ex">ctest</span> --show-only</span>
<span id="cb82-4"><a href="#cb82-4"></a></span>
<span id="cb82-5"><a href="#cb82-5"></a>    <span class="co"># run specific C++ or Python test(s) matching a regular expression</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>    <span class="ex">ctest</span> --verbose --tests-regex SomeTestName</span></code></pre></div>
<h1 id="authors-and-acknowledgments">9. Authors and Acknowledgments</h1>
<p>The following people have contributed to this document:</p>
<ul>
<li>Windows MINGW Section
<ul>
<li>Tim Sutton, Godofredo Contreras 2006</li>
<li>CMake additions Magnus Homann 2007</li>
<li>Python additions Martin Dobias 2007</li>
<li>With thanks to Tisham Dhar for preparing the initial msys environment</li>
</ul></li>
<li>Windows MSVC Section (Detailed install)
<ul>
<li>David Willis 2007</li>
<li>MSVC install additions Tim Sutton 2007</li>
<li>PostgreSQL, Qt compile, SIP, Python, AutoExp additions Juergen Fischer 2007</li>
</ul></li>
<li>Windows MSVC Section (Simplified install)
<ul>
<li>Tim Sutton 2007</li>
<li>Juergen Fischer 2007</li>
<li>Florian Hillen 2010</li>
</ul></li>
<li>OSX Section
<ul>
<li>Tim Sutton 2007</li>
<li>With special thanks to Tom Elwertowski and William Kyngesburye</li>
<li>Larry Shaffer 2012</li>
<li>Peter Petrik 2020</li>
</ul></li>
<li>GNU/Linux Section
<ul>
<li>Tim Sutton 2006</li>
<li>Debian package section: Juergen Fischer 2008</li>
</ul></li>
<li>WCS Test Server Section
<ul>
<li>Tim Sutton, Radim Blazek 2012</li>
</ul></li>
<li>Jenkins CI Configuration
<ul>
<li>Tim Sutton 2012</li>
</ul></li>
<li>Latex Generator
<ul>
<li>Tim Sutton 2011</li>
</ul></li>
<li>Debug Output/Tests Section
<ul>
<li>Larry Shaffer 2012, by way of ‘Test Friday’ Tim Sutton</li>
</ul></li>
</ul>
